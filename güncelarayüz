<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEMPO Hava Kalitesi İzleme</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 50%, #0369a1 100%);
        }
        .air-quality-excellent { background: linear-gradient(135deg, #10b981, #059669); }
        .air-quality-good { background: linear-gradient(135deg, #10b981, #059669); }
        .air-quality-moderate { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .air-quality-unhealthy { background: linear-gradient(135deg, #f97316, #ea580c); }
        .air-quality-very-unhealthy { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .air-quality-hazardous { background: linear-gradient(135deg, #7c2d12, #92400e); }
        
        .notification-slide {
            animation: slideInRight 0.5s ease-out;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .pulse-dot {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .search-dropdown {
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans min-h-screen">
    <!-- Navigation -->
    <nav class="gradient-bg text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                        <span class="text-2xl">🛰️</span>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold">TEMPO</h1>
                        <p class="text-xs opacity-90">Hava Kalitesi İzleme</p>
                    </div>
                </div>
                
                <div class="hidden md:flex space-x-6">
                    <button onclick="showSection('home')" class="nav-btn px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20 transition-colors flex items-center gap-2">
                        <div class="w-2 h-2 bg-green-400 rounded-full pulse-dot"></div>
                        Live
                    </button>
                    <button onclick="showSection('forecast')" class="nav-btn px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20 transition-colors">Hava Durumu</button>
                    <button onclick="showSection('map')" class="nav-btn px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20 transition-colors">Harita</button>
                    <button onclick="showSection('alerts')" class="nav-btn px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20 transition-colors">Bildirimler</button>
                    <button onclick="showSection('settings')" class="nav-btn px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20 transition-colors">Ayarlar</button>
                </div>
                
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="p-2">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden md:hidden bg-black bg-opacity-20">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <button onclick="showSection('home')" class="block w-full text-left px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20 flex items-center gap-2">
                    <div class="w-2 h-2 bg-green-400 rounded-full pulse-dot"></div>
                    Live
                </button>
                <button onclick="showSection('forecast')" class="block w-full text-left px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20">Hava Durumu</button>
                <button onclick="showSection('map')" class="block w-full text-left px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20">Harita</button>
                <button onclick="showSection('alerts')" class="block w-full text-left px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20">Bildirimler</button>
                <button onclick="showSection('settings')" class="block w-full text-left px-3 py-2 rounded-md hover:bg-white hover:bg-opacity-20">Ayarlar</button>
            </div>
        </div>
    </nav>

    <!-- Search Bar -->
    <div class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 py-3">
            <div class="flex flex-col sm:flex-row gap-3">
                <div class="flex-1 relative">
                    <input type="text" id="searchInput" placeholder="Şehir ara..." 
                           class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           oninput="showSearchSuggestions(this.value)"
                           onblur="hideSearchSuggestions()"
                           onfocus="showSearchSuggestions(this.value)">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center">
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </div>
                    <!-- Search Suggestions Dropdown -->
                    <div id="searchSuggestions" class="absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-lg shadow-lg z-50 hidden search-dropdown">
                        <!-- Suggestions will be populated here -->
                    </div>
                </div>
                <button onclick="searchLocation()" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                    Ara
                </button>
                <button onclick="getCurrentLocation()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    Konumum
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        
        <!-- Home Section -->
        <div id="homeSection" class="section">
            <!-- Current Air Quality Card -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <div class="flex flex-col lg:flex-row items-center justify-between">
                    <div class="text-center lg:text-left mb-4 lg:mb-0">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Mevcut Hava Kalitesi</h2>
                        <p id="currentLocation" class="text-gray-600 mb-4">📍 New York City, ABD</p>
                        <div class="flex items-center justify-center lg:justify-start gap-4">
                            <div id="aqiValue" class="text-6xl font-bold text-emerald-600">42</div>
                            <div>
                                <div id="aqiStatus" class="text-xl font-semibold text-emerald-600">İyi</div>
                                <div class="text-sm text-gray-500">AQI Değeri</div>
                            </div>
                        </div>
                    </div>
                    <div id="aqiCircle" class="w-32 h-32 rounded-full air-quality-good flex items-center justify-center text-white font-bold text-lg">
                        <div class="text-center">
                            <div class="text-2xl">😊</div>
                            <div class="text-xs">Temiz</div>
                        </div>
                    </div>
                </div>
                
                <!-- Pollutant Details -->
                <div class="grid grid-cols-2 md:grid-cols-5 gap-6 mt-6 pt-6 border-t border-gray-200">
                    <div class="text-center relative group cursor-help">
                        <div class="text-2xl font-bold text-blue-600" id="pm25">12</div>
                        <div class="text-sm text-gray-600">PM2.5</div>
                        <div class="text-xs text-gray-500">µg/m³</div>
                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10">
                            2.5 mikrometreden küçük partiküller. Akciğerlere nüfuz eder ve sağlık sorunlarına neden olabilir.
                        </div>
                    </div>
                    <div class="text-center relative group cursor-help">
                        <div class="text-2xl font-bold text-amber-600" id="pm10">18</div>
                        <div class="text-sm text-gray-600">PM10</div>
                        <div class="text-xs text-gray-500">µg/m³</div>
                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10">
                            10 mikrometreden küçük partiküller. Solunum yollarını etkileyebilir.
                        </div>
                    </div>
                    <div class="text-center relative group cursor-help">
                        <div class="text-2xl font-bold text-rose-600" id="no2">25</div>
                        <div class="text-sm text-gray-600">NO₂</div>
                        <div class="text-xs text-gray-500">µg/m³</div>
                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10">
                            Azot dioksit. Araç egzozlarından çıkar, astım ve solunum problemlerine neden olur.
                        </div>
                    </div>
                    <div class="text-center relative group cursor-help">
                        <div class="text-2xl font-bold text-orange-600" id="o3">85</div>
                        <div class="text-sm text-gray-600">O₃</div>
                        <div class="text-xs text-gray-500">µg/m³</div>
                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10">
                            Ozon. Yüksek seviyelerde göğüs ağrısı ve nefes darlığına neden olabilir.
                        </div>
                    </div>
                    <div class="text-center relative group cursor-help">
                        <div class="text-2xl font-bold text-emerald-600" id="co">0.8</div>
                        <div class="text-sm text-gray-600">CO</div>
                        <div class="text-xs text-gray-500">mg/m³</div>
                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10">
                            Karbon monoksit. Renksiz, kokusuz gaz. Yüksek seviyelerde zehirleyici olabilir.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats - 3x2 Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <!-- First Row -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">Hava Durumu</h3>
                            <p class="text-3xl font-bold text-blue-600 mt-2">22°C</p>
                            <p class="text-sm text-gray-600">Parçalı bulutlu</p>
                        </div>
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="text-2xl">⛅</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">Nem</h3>
                            <div class="flex items-center gap-2 mt-2">
                                <p id="humidityValue" class="text-3xl font-bold text-cyan-600">68%</p>
                                <div id="humidityTrend" class="flex items-center text-green-600">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 17l9.2-9.2M17 17V7H7"></path>
                                    </svg>
                                    <span class="text-xs ml-1">Yükseliyor</span>
                                </div>
                            </div>
                            <p class="text-sm text-gray-600">Orta seviye</p>
                        </div>
                        <div class="w-16 h-16 bg-cyan-100 rounded-full flex items-center justify-center">
                            <span class="text-2xl">💧</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">Rüzgar</h3>
                            <p id="windValue" class="text-3xl font-bold text-violet-600 mt-2">12 km/h</p>
                            <p class="text-sm text-gray-600">Kuzeybatı</p>
                        </div>
                        <div class="w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center">
                            <span class="text-2xl">💨</span>
                        </div>
                    </div>
                </div>
                
                <!-- Second Row -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">Yağış</h3>
                            <p id="precipitationValue" class="text-3xl font-bold text-blue-600 mt-2">2.5mm</p>
                            <p class="text-sm text-gray-600">Son 24 saat</p>
                        </div>
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="text-2xl">🌧️</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">Basınç</h3>
                            <p id="pressureValue" class="text-3xl font-bold text-green-600 mt-2">1013</p>
                            <p class="text-sm text-gray-600">hPa</p>
                        </div>
                        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center">
                            <span class="text-2xl">📊</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">Polen</h3>
                            <p id="pollenValue" class="text-3xl font-bold text-orange-600 mt-2">Orta</p>
                            <p class="text-sm text-gray-600">Ağaç poleni</p>
                        </div>
                        <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center">
                            <span class="text-2xl">🌸</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Activity and Health Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- Activity Suitability -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Aktivite Durumu</h3>
                    
                    <div class="relative h-48 overflow-hidden">
                        <div id="activityContainer" class="flex h-full transition-transform duration-300 ease-in-out" style="width: max-content;">
                            <!-- Activities will be populated by JavaScript -->
                        </div>
                        
                        <!-- Navigation dots -->
                        <div id="activityDots" class="absolute bottom-2 left-1/2 transform -translate-x-1/2 flex gap-2">
                            <!-- Dots will be populated by JavaScript -->
                        </div>
                        
                        <!-- Navigation arrows -->
                        <button id="prevActivity" onclick="previousActivity()" class="absolute left-2 top-1/2 transform -translate-y-1/2 w-8 h-8 bg-white bg-opacity-80 rounded-full shadow-md flex items-center justify-center hover:bg-opacity-100 transition-all">
                            <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                        </button>
                        <button id="nextActivity" onclick="nextActivity()" class="absolute right-2 top-1/2 transform -translate-y-1/2 w-8 h-8 bg-white bg-opacity-80 rounded-full shadow-md flex items-center justify-center hover:bg-opacity-100 transition-all">
                            <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Sunrise & Sunset -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="text-xl">☀️</span>
                        Güneş Doğum & Batım
                    </h3>
                    
                    <div class="space-y-6">
                        <!-- Sunrise -->
                        <div class="flex items-center justify-between p-4 bg-gradient-to-r from-orange-50 to-yellow-50 rounded-lg border border-orange-100">
                            <div class="flex items-center gap-3">
                                <div class="w-12 h-12 bg-gradient-to-br from-orange-400 to-yellow-400 rounded-full flex items-center justify-center">
                                    <span class="text-white text-lg">🌅</span>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Güneş Doğumu</h4>
                                    <p class="text-sm text-gray-600">Bugün</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <div id="sunriseTime" class="text-2xl font-bold text-orange-600">06:42</div>
                                <div class="text-xs text-gray-500">EST</div>
                            </div>
                        </div>
                        
                        <!-- Sunset -->
                        <div class="flex items-center justify-between p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-100">
                            <div class="flex items-center gap-3">
                                <div class="w-12 h-12 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center">
                                    <span class="text-white text-lg">🌇</span>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Güneş Batımı</h4>
                                    <p class="text-sm text-gray-600">Bugün</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <div id="sunsetTime" class="text-2xl font-bold text-purple-600">16:58</div>
                                <div class="text-xs text-gray-500">EST</div>
                            </div>
                        </div>
                        
                        <!-- Current Sun Position -->
                        <div class="p-4 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg border border-gray-100">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-800">Güneş Konumu</h4>
                                <span id="currentSunStatus" class="text-sm font-medium text-blue-600">Gündüz</span>
                            </div>
                            <div class="relative">
                                <div class="w-full h-2 bg-gray-200 rounded-full">
                                    <div id="sunProgress" class="h-2 bg-gradient-to-r from-orange-400 to-yellow-400 rounded-full" style="width: 65%;"></div>
                                </div>
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>Doğum</span>
                                    <span>Öğle</span>
                                    <span>Batım</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>

        <!-- Forecast Section -->
        <div id="forecastSection" class="section hidden">
            <!-- Forecast Toggle Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 mb-6">
                <button id="forecast7Day" onclick="showForecast('7day')" 
                        class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium shadow-sm">
                    7 Günlük Tahmin
                </button>
                <button id="forecast24Hour" onclick="showForecast('24hour')" 
                        class="px-6 py-3 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors font-medium">
                    24 Saatlik Tahmin
                </button>
            </div>

            <!-- 7-Day Forecast -->
            <div id="forecast7DayData" class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span class="text-2xl">🤖</span>
                    7 Günlük Hava Durumu Tahmini
                </h2>
                
                <!-- Weather Table -->
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-gray-200">
                                <th class="text-left py-3 px-4 font-semibold text-gray-700">Gün</th>
                                <th class="text-center py-3 px-4 font-semibold text-gray-700">Hava</th>
                                <th class="text-center py-3 px-4 font-semibold text-gray-700">Sıcaklık</th>
                                <th class="text-center py-3 px-4 font-semibold text-gray-700">Nem</th>
                                <th class="text-center py-3 px-4 font-semibold text-gray-700">Rüzgar</th>
                                <th class="text-center py-3 px-4 font-semibold text-gray-700">Yağış</th>
                                <th class="text-center py-3 px-4 font-semibold text-gray-700">AQI</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-4 px-4">
                                    <div class="font-semibold text-gray-800">Bugün</div>
                                    <div class="text-sm text-gray-500">15 Aralık</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-3xl mb-1">☀️</div>
                                    <div class="text-sm text-gray-600">Güneşli</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-xl font-bold text-blue-600">22°C</div>
                                    <div class="text-sm text-gray-500">Min: 15°C</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-cyan-600">68%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-violet-600">12 km/h</div>
                                    <div class="text-sm text-gray-500">KB</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-blue-600">0%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-green-600">42</div>
                                    <div class="text-sm text-gray-500">İyi</div>
                                </td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-4 px-4">
                                    <div class="font-semibold text-gray-800">Yarın</div>
                                    <div class="text-sm text-gray-500">16 Aralık</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-3xl mb-1">⛅</div>
                                    <div class="text-sm text-gray-600">Parçalı Bulutlu</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-xl font-bold text-gray-600">19°C</div>
                                    <div class="text-sm text-gray-500">Min: 12°C</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-cyan-600">72%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-violet-600">15 km/h</div>
                                    <div class="text-sm text-gray-500">K</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-blue-600">10%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-yellow-600">58</div>
                                    <div class="text-sm text-gray-500">Orta</div>
                                </td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-4 px-4">
                                    <div class="font-semibold text-gray-800">Pazartesi</div>
                                    <div class="text-sm text-gray-500">17 Aralık</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-3xl mb-1">🌧️</div>
                                    <div class="text-sm text-gray-600">Yağmurlu</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-xl font-bold text-blue-600">16°C</div>
                                    <div class="text-sm text-gray-500">Min: 9°C</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-cyan-600">85%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-violet-600">8 km/h</div>
                                    <div class="text-sm text-gray-500">GD</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-blue-600">75%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-orange-600">78</div>
                                    <div class="text-sm text-gray-500">Orta</div>
                                </td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-4 px-4">
                                    <div class="font-semibold text-gray-800">Salı</div>
                                    <div class="text-sm text-gray-500">18 Aralık</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-3xl mb-1">☁️</div>
                                    <div class="text-sm text-gray-600">Bulutlu</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-xl font-bold text-orange-600">18°C</div>
                                    <div class="text-sm text-gray-500">Min: 11°C</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-cyan-600">78%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-violet-600">10 km/h</div>
                                    <div class="text-sm text-gray-500">B</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-blue-600">20%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-green-600">45</div>
                                    <div class="text-sm text-gray-500">İyi</div>
                                </td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-4 px-4">
                                    <div class="font-semibold text-gray-800">Çarşamba</div>
                                    <div class="text-sm text-gray-500">19 Aralık</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-3xl mb-1">🌤️</div>
                                    <div class="text-sm text-gray-600">Az Bulutlu</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-xl font-bold text-green-600">25°C</div>
                                    <div class="text-sm text-gray-500">Min: 18°C</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-cyan-600">55%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-violet-600">14 km/h</div>
                                    <div class="text-sm text-gray-500">GB</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-blue-600">5%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-green-600">35</div>
                                    <div class="text-sm text-gray-500">İyi</div>
                                </td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-4 px-4">
                                    <div class="font-semibold text-gray-800">Perşembe</div>
                                    <div class="text-sm text-gray-500">20 Aralık</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-3xl mb-1">☀️</div>
                                    <div class="text-sm text-gray-600">Güneşli</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-xl font-bold text-yellow-600">28°C</div>
                                    <div class="text-sm text-gray-500">Min: 21°C</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-cyan-600">48%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-violet-600">16 km/h</div>
                                    <div class="text-sm text-gray-500">G</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-blue-600">0%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-green-600">28</div>
                                    <div class="text-sm text-gray-500">İyi</div>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="py-4 px-4">
                                    <div class="font-semibold text-gray-800">Cuma</div>
                                    <div class="text-sm text-gray-500">21 Aralık</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-3xl mb-1">⛈️</div>
                                    <div class="text-sm text-gray-600">Fırtınalı</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-xl font-bold text-purple-600">21°C</div>
                                    <div class="text-sm text-gray-500">Min: 14°C</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-cyan-600">88%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-violet-600">22 km/h</div>
                                    <div class="text-sm text-gray-500">KB</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-blue-600">90%</div>
                                </td>
                                <td class="py-4 px-4 text-center">
                                    <div class="text-lg font-semibold text-red-600">95</div>
                                    <div class="text-sm text-gray-500">Orta</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 24-Hour Forecast -->
            <div id="forecast24HourData" class="bg-white rounded-xl shadow-lg p-6 hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span class="text-2xl">🤖</span>
                    24 Saatlik Hava Durumu Tahmini
                </h2>
                
                <!-- Hourly Weather Table -->
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-gray-200">
                                <th class="text-left py-3 px-3 font-semibold text-gray-700">Saat</th>
                                <th class="text-center py-3 px-3 font-semibold text-gray-700">Hava</th>
                                <th class="text-center py-3 px-3 font-semibold text-gray-700">Sıcaklık</th>
                                <th class="text-center py-3 px-3 font-semibold text-gray-700">Nem</th>
                                <th class="text-center py-3 px-3 font-semibold text-gray-700">Rüzgar</th>
                                <th class="text-center py-3 px-3 font-semibold text-gray-700">Yağış</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3 font-semibold text-blue-600">Şimdi</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">☀️</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-blue-600">22°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">68%</td>
                                <td class="py-3 px-3 text-center text-violet-600">12 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">0%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">15:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">☀️</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-orange-600">24°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">65%</td>
                                <td class="py-3 px-3 text-center text-violet-600">14 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">0%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">16:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">🌤️</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-yellow-600">25°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">62%</td>
                                <td class="py-3 px-3 text-center text-violet-600">15 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">5%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">17:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">☀️</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-yellow-600">26°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">58%</td>
                                <td class="py-3 px-3 text-center text-violet-600">16 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">0%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">18:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">🌅</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-orange-600">23°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">64%</td>
                                <td class="py-3 px-3 text-center text-violet-600">13 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">0%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">19:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">🌙</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-indigo-600">21°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">68%</td>
                                <td class="py-3 px-3 text-center text-violet-600">11 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">0%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">20:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">🌙</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-blue-600">19°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">72%</td>
                                <td class="py-3 px-3 text-center text-violet-600">10 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">0%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">21:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">🌙</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-gray-600">18°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">75%</td>
                                <td class="py-3 px-3 text-center text-violet-600">9 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">0%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">22:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">🌙</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-green-600">17°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">78%</td>
                                <td class="py-3 px-3 text-center text-violet-600">8 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">0%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">23:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">🌙</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-teal-600">16°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">80%</td>
                                <td class="py-3 px-3 text-center text-violet-600">7 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">5%</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-3">00:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">🌙</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-cyan-600">15°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">82%</td>
                                <td class="py-3 px-3 text-center text-violet-600">6 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">10%</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="py-3 px-3">01:00</td>
                                <td class="py-3 px-3 text-center">
                                    <div class="text-2xl">🌙</div>
                                </td>
                                <td class="py-3 px-3 text-center font-bold text-emerald-600">14°C</td>
                                <td class="py-3 px-3 text-center text-cyan-600">85%</td>
                                <td class="py-3 px-3 text-center text-violet-600">5 km/h</td>
                                <td class="py-3 px-3 text-center text-blue-600">15%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Map Section -->
        <div id="mapSection" class="section hidden">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <div class="flex flex-col lg:flex-row gap-4 mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 flex-1">Hava Kalitesi Haritası</h2>
                    
                    <!-- Data Layer Selection -->
                    <div class="flex flex-wrap gap-2">
                        <button onclick="changeMapLayer('pm25')" id="layerPM25" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium">
                            PM2.5
                        </button>
                        <button onclick="changeMapLayer('pm10')" id="layerPM10" class="px-4 py-2 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                            PM10
                        </button>
                        <button onclick="changeMapLayer('no2')" id="layerNO2" class="px-4 py-2 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                            NO₂
                        </button>
                        <button onclick="changeMapLayer('o3')" id="layerO3" class="px-4 py-2 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                            O₃
                        </button>
                        <button onclick="changeMapLayer('co')" id="layerCO" class="px-4 py-2 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                            CO
                        </button>
                    </div>
                </div>
                
                <!-- Legend -->
                <div class="mb-4 p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center gap-4 text-sm">
                        <span class="font-medium text-gray-700">Renk Kodları:</span>
                        <div class="flex items-center gap-1">
                            <div class="w-4 h-4 bg-green-500 rounded"></div>
                            <span class="text-gray-600">İyi</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <div class="w-4 h-4 bg-yellow-500 rounded"></div>
                            <span class="text-gray-600">Orta</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <div class="w-4 h-4 bg-orange-500 rounded"></div>
                            <span class="text-gray-600">Kötü</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <div class="w-4 h-4 bg-red-500 rounded"></div>
                            <span class="text-gray-600">Tehlikeli</span>
                        </div>
                    </div>
                </div>
                
                <div id="map" class="w-full h-96 rounded-lg border"></div>
            </div>
        </div>

        <!-- Alerts Section -->
        <div id="alertsSection" class="section hidden">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Bildirimler</h2>
                
                <div class="space-y-4">
                    <div class="flex items-start gap-3 p-4 bg-green-50 border border-green-200 rounded-lg">
                        <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm">✓</div>
                        <div>
                            <h4 class="font-medium text-green-800">Hava Kalitesi İyi</h4>
                            <p class="text-sm text-green-700">Tüm aktiviteler için uygun</p>
                            <p class="text-xs text-green-600 mt-1">2 dakika önce</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm">i</div>
                        <div>
                            <h4 class="font-medium text-blue-800">Hava Durumu Güncellemesi</h4>
                            <p class="text-sm text-blue-700">Bugün parçalı bulutlu</p>
                            <p class="text-xs text-blue-600 mt-1">15 dakika önce</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settingsSection" class="section hidden">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Ayarlar</h2>
                
                <div class="space-y-6">
                    <!-- Activity Preferences -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Aktivite Tercihleri</h3>
                        <p class="text-sm text-gray-600 mb-4">Hangi aktivitelerin Live sekmesinde gösterilmesini istiyorsunuz?</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="activity-running" checked class="mr-3 text-blue-600" onchange="updateActivityPreferences()">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                        <span class="text-sm">🏃‍♂️</span>
                                    </div>
                                    <span class="text-gray-700 font-medium">Koşu</span>
                                </div>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="activity-cycling" checked class="mr-3 text-blue-600" onchange="updateActivityPreferences()">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center">
                                        <span class="text-sm">🚴‍♂️</span>
                                    </div>
                                    <span class="text-gray-700 font-medium">Bisiklet</span>
                                </div>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="activity-walking" class="mr-3 text-blue-600" onchange="updateActivityPreferences()">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                        <span class="text-sm">🚶‍♂️</span>
                                    </div>
                                    <span class="text-gray-700 font-medium">Yürüyüş</span>
                                </div>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="activity-sports" class="mr-3 text-blue-600" onchange="updateActivityPreferences()">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                        <span class="text-sm">⚽</span>
                                    </div>
                                    <span class="text-gray-700 font-medium">Açık Hava Sporu</span>
                                </div>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="activity-swimming" class="mr-3 text-blue-600" onchange="updateActivityPreferences()">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                        <span class="text-sm">🏊‍♂️</span>
                                    </div>
                                    <span class="text-gray-700 font-medium">Yüzme</span>
                                </div>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="activity-hiking" class="mr-3 text-blue-600" onchange="updateActivityPreferences()">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center">
                                        <span class="text-sm">🥾</span>
                                    </div>
                                    <span class="text-gray-700 font-medium">Doğa Yürüyüşü</span>
                                </div>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="activity-tennis" class="mr-3 text-blue-600" onchange="updateActivityPreferences()">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                        <span class="text-sm">🎾</span>
                                    </div>
                                    <span class="text-gray-700 font-medium">Tenis</span>
                                </div>
                            </label>
                            
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                                <input type="checkbox" id="activity-golf" class="mr-3 text-blue-600" onchange="updateActivityPreferences()">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center">
                                        <span class="text-sm">⛳</span>
                                    </div>
                                    <span class="text-gray-700 font-medium">Golf</span>
                                </div>
                            </label>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="fixed top-20 right-4 z-50 space-y-2"></div>

    <script>
        let map;
        let currentChart;
        let currentMapLayer = 'pm25';
        
        // North American countries, states/provinces, and cities for search suggestions
        const northAmericanCountries = [
            { name: 'ABD', type: 'country', lat: 39.8283, lng: -98.5795 },
            { name: 'Kanada', type: 'country', lat: 56.1304, lng: -106.3468 },
            { name: 'Meksika', type: 'country', lat: 23.6345, lng: -102.5528 }
        ];
        
        const northAmericanStates = [
            // US States
            { name: 'Alabama', country: 'ABD', type: 'state', lat: 32.3617, lng: -86.2792 },
            { name: 'Alaska', country: 'ABD', type: 'state', lat: 64.0685, lng: -152.2782 },
            { name: 'Arizona', country: 'ABD', type: 'state', lat: 34.2744, lng: -111.2847 },
            { name: 'Arkansas', country: 'ABD', type: 'state', lat: 34.7519, lng: -92.1313 },
            { name: 'California', country: 'ABD', type: 'state', lat: 36.7783, lng: -119.4179 },
            { name: 'Colorado', country: 'ABD', type: 'state', lat: 39.5501, lng: -105.7821 },
            { name: 'Connecticut', country: 'ABD', type: 'state', lat: 41.6032, lng: -73.0877 },
            { name: 'Delaware', country: 'ABD', type: 'state', lat: 38.9108, lng: -75.5277 },
            { name: 'Florida', country: 'ABD', type: 'state', lat: 27.7663, lng: -81.6868 },
            { name: 'Georgia', country: 'ABD', type: 'state', lat: 32.1656, lng: -82.9001 },
            { name: 'Hawaii', country: 'ABD', type: 'state', lat: 19.8968, lng: -155.5828 },
            { name: 'Idaho', country: 'ABD', type: 'state', lat: 44.0682, lng: -114.7420 },
            { name: 'Illinois', country: 'ABD', type: 'state', lat: 40.6331, lng: -89.3985 },
            { name: 'Indiana', country: 'ABD', type: 'state', lat: 40.2732, lng: -86.1349 },
            { name: 'Iowa', country: 'ABD', type: 'state', lat: 41.8780, lng: -93.0977 },
            { name: 'Kansas', country: 'ABD', type: 'state', lat: 38.5266, lng: -96.7265 },
            { name: 'Kentucky', country: 'ABD', type: 'state', lat: 37.8393, lng: -84.2700 },
            { name: 'Louisiana', country: 'ABD', type: 'state', lat: 31.2448, lng: -92.1450 },
            { name: 'Maine', country: 'ABD', type: 'state', lat: 45.2538, lng: -69.4455 },
            { name: 'Maryland', country: 'ABD', type: 'state', lat: 39.0458, lng: -76.6413 },
            { name: 'Massachusetts', country: 'ABD', type: 'state', lat: 42.4072, lng: -71.3824 },
            { name: 'Michigan', country: 'ABD', type: 'state', lat: 44.3467, lng: -85.4102 },
            { name: 'Minnesota', country: 'ABD', type: 'state', lat: 46.7296, lng: -94.6859 },
            { name: 'Mississippi', country: 'ABD', type: 'state', lat: 32.3547, lng: -89.3985 },
            { name: 'Missouri', country: 'ABD', type: 'state', lat: 37.9643, lng: -91.8318 },
            { name: 'Montana', country: 'ABD', type: 'state', lat: 47.0527, lng: -109.6333 },
            { name: 'Nebraska', country: 'ABD', type: 'state', lat: 41.4925, lng: -99.9018 },
            { name: 'Nevada', country: 'ABD', type: 'state', lat: 38.8026, lng: -116.4194 },
            { name: 'New Hampshire', country: 'ABD', type: 'state', lat: 43.1939, lng: -71.5724 },
            { name: 'New Jersey', country: 'ABD', type: 'state', lat: 40.0583, lng: -74.4057 },
            { name: 'New Mexico', country: 'ABD', type: 'state', lat: 34.5199, lng: -105.8701 },
            { name: 'New York', country: 'ABD', type: 'state', lat: 43.2994, lng: -74.2179 },
            { name: 'North Carolina', country: 'ABD', type: 'state', lat: 35.7596, lng: -79.0193 },
            { name: 'North Dakota', country: 'ABD', type: 'state', lat: 47.5515, lng: -101.0020 },
            { name: 'Ohio', country: 'ABD', type: 'state', lat: 40.4173, lng: -82.9071 },
            { name: 'Oklahoma', country: 'ABD', type: 'state', lat: 35.0078, lng: -97.0929 },
            { name: 'Oregon', country: 'ABD', type: 'state', lat: 43.8041, lng: -120.5542 },
            { name: 'Pennsylvania', country: 'ABD', type: 'state', lat: 41.2033, lng: -77.1945 },
            { name: 'Rhode Island', country: 'ABD', type: 'state', lat: 41.6809, lng: -71.5118 },
            { name: 'South Carolina', country: 'ABD', type: 'state', lat: 33.8361, lng: -81.1637 },
            { name: 'South Dakota', country: 'ABD', type: 'state', lat: 43.9695, lng: -99.9018 },
            { name: 'Tennessee', country: 'ABD', type: 'state', lat: 35.5175, lng: -86.5804 },
            { name: 'Texas', country: 'ABD', type: 'state', lat: 31.9686, lng: -99.9018 },
            { name: 'Utah', country: 'ABD', type: 'state', lat: 39.3210, lng: -111.0937 },
            { name: 'Vermont', country: 'ABD', type: 'state', lat: 44.2601, lng: -72.5806 },
            { name: 'Virginia', country: 'ABD', type: 'state', lat: 37.4316, lng: -78.6569 },
            { name: 'Washington', country: 'ABD', type: 'state', lat: 47.7511, lng: -120.7401 },
            { name: 'West Virginia', country: 'ABD', type: 'state', lat: 38.3498, lng: -80.6547 },
            { name: 'Wisconsin', country: 'ABD', type: 'state', lat: 43.7844, lng: -88.7879 },
            { name: 'Wyoming', country: 'ABD', type: 'state', lat: 43.0759, lng: -107.2903 },
            
            // Canadian Provinces and Territories
            { name: 'Alberta', country: 'Kanada', type: 'province', lat: 53.9333, lng: -116.5765 },
            { name: 'British Columbia', country: 'Kanada', type: 'province', lat: 53.7267, lng: -127.6476 },
            { name: 'Manitoba', country: 'Kanada', type: 'province', lat: 53.7609, lng: -98.8139 },
            { name: 'New Brunswick', country: 'Kanada', type: 'province', lat: 46.5653, lng: -66.4619 },
            { name: 'Newfoundland and Labrador', country: 'Kanada', type: 'province', lat: 53.1355, lng: -57.6604 },
            { name: 'Northwest Territories', country: 'Kanada', type: 'territory', lat: 64.8255, lng: -124.8457 },
            { name: 'Nova Scotia', country: 'Kanada', type: 'province', lat: 44.6820, lng: -63.7443 },
            { name: 'Nunavut', country: 'Kanada', type: 'territory', lat: 70.2998, lng: -83.1076 },
            { name: 'Ontario', country: 'Kanada', type: 'province', lat: 51.2538, lng: -85.3232 },
            { name: 'Prince Edward Island', country: 'Kanada', type: 'province', lat: 46.5107, lng: -63.4168 },
            { name: 'Quebec', country: 'Kanada', type: 'province', lat: 52.9399, lng: -73.5491 },
            { name: 'Saskatchewan', country: 'Kanada', type: 'province', lat: 52.9399, lng: -106.4509 },
            { name: 'Yukon', country: 'Kanada', type: 'territory', lat: 64.2823, lng: -135.0000 },
            
            // Mexican States
            { name: 'Aguascalientes', country: 'Meksika', type: 'state', lat: 21.8853, lng: -102.2916 },
            { name: 'Baja California', country: 'Meksika', type: 'state', lat: 30.8406, lng: -115.2838 },
            { name: 'Baja California Sur', country: 'Meksika', type: 'state', lat: 26.0444, lng: -111.6660 },
            { name: 'Campeche', country: 'Meksika', type: 'state', lat: 19.8301, lng: -90.5349 },
            { name: 'Chiapas', country: 'Meksika', type: 'state', lat: 16.7569, lng: -93.1292 },
            { name: 'Chihuahua', country: 'Meksika', type: 'state', lat: 28.6353, lng: -106.0889 },
            { name: 'Coahuila', country: 'Meksika', type: 'state', lat: 27.0587, lng: -101.7068 },
            { name: 'Colima', country: 'Meksika', type: 'state', lat: 19.2452, lng: -103.7240 },
            { name: 'Durango', country: 'Meksika', type: 'state', lat: 24.5594, lng: -104.6591 },
            { name: 'Guanajuato', country: 'Meksika', type: 'state', lat: 21.0190, lng: -101.2574 },
            { name: 'Guerrero', country: 'Meksika', type: 'state', lat: 17.4392, lng: -99.5451 },
            { name: 'Hidalgo', country: 'Meksika', type: 'state', lat: 20.1011, lng: -98.7624 },
            { name: 'Jalisco', country: 'Meksika', type: 'state', lat: 20.6597, lng: -103.3496 },
            { name: 'México', country: 'Meksika', type: 'state', lat: 19.2808, lng: -99.7559 },
            { name: 'Michoacán', country: 'Meksika', type: 'state', lat: 19.5665, lng: -101.7068 },
            { name: 'Morelos', country: 'Meksika', type: 'state', lat: 18.6813, lng: -99.1013 },
            { name: 'Nayarit', country: 'Meksika', type: 'state', lat: 21.7514, lng: -104.8455 },
            { name: 'Nuevo León', country: 'Meksika', type: 'state', lat: 25.5922, lng: -99.9962 },
            { name: 'Oaxaca', country: 'Meksika', type: 'state', lat: 17.0732, lng: -96.7266 },
            { name: 'Puebla', country: 'Meksika', type: 'state', lat: 19.0414, lng: -98.2063 },
            { name: 'Querétaro', country: 'Meksika', type: 'state', lat: 20.5888, lng: -100.3899 },
            { name: 'Quintana Roo', country: 'Meksika', type: 'state', lat: 19.1817, lng: -88.4791 },
            { name: 'San Luis Potosí', country: 'Meksika', type: 'state', lat: 22.1565, lng: -100.9855 },
            { name: 'Sinaloa', country: 'Meksika', type: 'state', lat: 25.1721, lng: -107.4795 },
            { name: 'Sonora', country: 'Meksika', type: 'state', lat: 29.2972, lng: -110.3309 },
            { name: 'Tabasco', country: 'Meksika', type: 'state', lat: 17.8409, lng: -92.6189 },
            { name: 'Tamaulipas', country: 'Meksika', type: 'state', lat: 24.2669, lng: -98.8363 },
            { name: 'Tlaxcala', country: 'Meksika', type: 'state', lat: 19.3139, lng: -98.2404 },
            { name: 'Veracruz', country: 'Meksika', type: 'state', lat: 19.1738, lng: -96.1342 },
            { name: 'Yucatán', country: 'Meksika', type: 'state', lat: 20.7099, lng: -89.0943 },
            { name: 'Zacatecas', country: 'Meksika', type: 'state', lat: 22.7709, lng: -102.5832 }
        ];
        
        const northAmericanCities = [
            { name: 'New York City', country: 'ABD', state: 'New York', lat: 40.7128, lng: -74.0060 },
            { name: 'Los Angeles', country: 'ABD', state: 'California', lat: 34.0522, lng: -118.2437 },
            { name: 'Chicago', country: 'ABD', state: 'Illinois', lat: 41.8781, lng: -87.6298 },
            { name: 'Houston', country: 'ABD', state: 'Texas', lat: 29.7604, lng: -95.3698 },
            { name: 'Phoenix', country: 'ABD', state: 'Arizona', lat: 33.4484, lng: -112.0740 },
            { name: 'Philadelphia', country: 'ABD', state: 'Pennsylvania', lat: 39.9526, lng: -75.1652 },
            { name: 'San Antonio', country: 'ABD', state: 'Texas', lat: 29.4241, lng: -98.4936 },
            { name: 'San Diego', country: 'ABD', state: 'California', lat: 32.7157, lng: -117.1611 },
            { name: 'Dallas', country: 'ABD', state: 'Texas', lat: 32.7767, lng: -96.7970 },
            { name: 'San Jose', country: 'ABD', state: 'California', lat: 37.3382, lng: -121.8863 },
            { name: 'Austin', country: 'ABD', state: 'Texas', lat: 30.2672, lng: -97.7431 },
            { name: 'Jacksonville', country: 'ABD', state: 'Florida', lat: 30.3322, lng: -81.6557 },
            { name: 'San Francisco', country: 'ABD', state: 'California', lat: 37.7749, lng: -122.4194 },
            { name: 'Columbus', country: 'ABD', state: 'Ohio', lat: 39.9612, lng: -82.9988 },
            { name: 'Fort Worth', country: 'ABD', state: 'Texas', lat: 32.7555, lng: -97.3308 },
            { name: 'Indianapolis', country: 'ABD', state: 'Indiana', lat: 39.7684, lng: -86.1581 },
            { name: 'Charlotte', country: 'ABD', state: 'North Carolina', lat: 35.2271, lng: -80.8431 },
            { name: 'Seattle', country: 'ABD', state: 'Washington', lat: 47.6062, lng: -122.3321 },
            { name: 'Denver', country: 'ABD', state: 'Colorado', lat: 39.7392, lng: -104.9903 },
            { name: 'Boston', country: 'ABD', state: 'Massachusetts', lat: 42.3601, lng: -71.0589 },
            { name: 'El Paso', country: 'ABD', state: 'Texas', lat: 31.7619, lng: -106.4850 },
            { name: 'Detroit', country: 'ABD', state: 'Michigan', lat: 42.3314, lng: -83.0458 },
            { name: 'Nashville', country: 'ABD', state: 'Tennessee', lat: 36.1627, lng: -86.7816 },
            { name: 'Portland', country: 'ABD', state: 'Oregon', lat: 45.5152, lng: -122.6784 },
            { name: 'Oklahoma City', country: 'ABD', state: 'Oklahoma', lat: 35.4676, lng: -97.5164 },
            { name: 'Las Vegas', country: 'ABD', state: 'Nevada', lat: 36.1699, lng: -115.1398 },
            { name: 'Louisville', country: 'ABD', state: 'Kentucky', lat: 38.2527, lng: -85.7585 },
            { name: 'Baltimore', country: 'ABD', state: 'Maryland', lat: 39.2904, lng: -76.6122 },
            { name: 'Milwaukee', country: 'ABD', state: 'Wisconsin', lat: 43.0389, lng: -87.9065 },
            { name: 'Albuquerque', country: 'ABD', state: 'New Mexico', lat: 35.0844, lng: -106.6504 },
            { name: 'Tucson', country: 'ABD', state: 'Arizona', lat: 32.2226, lng: -110.9747 },
            { name: 'Fresno', country: 'ABD', state: 'California', lat: 36.7378, lng: -119.7871 },
            { name: 'Sacramento', country: 'ABD', state: 'California', lat: 38.5816, lng: -121.4944 },
            { name: 'Kansas City', country: 'ABD', state: 'Missouri', lat: 39.0997, lng: -94.5786 },
            { name: 'Mesa', country: 'ABD', state: 'Arizona', lat: 33.4152, lng: -111.8315 },
            { name: 'Atlanta', country: 'ABD', state: 'Georgia', lat: 33.7490, lng: -84.3880 },
            { name: 'Colorado Springs', country: 'ABD', state: 'Colorado', lat: 38.8339, lng: -104.8214 },
            { name: 'Raleigh', country: 'ABD', state: 'North Carolina', lat: 35.7796, lng: -78.6382 },
            { name: 'Omaha', country: 'ABD', state: 'Nebraska', lat: 41.2565, lng: -95.9345 },
            { name: 'Miami', country: 'ABD', state: 'Florida', lat: 25.7617, lng: -80.1918 },
            { name: 'Oakland', country: 'ABD', state: 'California', lat: 37.8044, lng: -122.2712 },
            { name: 'Minneapolis', country: 'ABD', state: 'Minnesota', lat: 44.9778, lng: -93.2650 },
            { name: 'Tulsa', country: 'ABD', state: 'Oklahoma', lat: 36.1540, lng: -95.9928 },
            { name: 'Cleveland', country: 'ABD', state: 'Ohio', lat: 41.4993, lng: -81.6944 },
            { name: 'Wichita', country: 'ABD', state: 'Kansas', lat: 37.6872, lng: -97.3301 },
            { name: 'Arlington', country: 'ABD', state: 'Texas', lat: 32.7357, lng: -97.1081 },
            
            // Canadian Cities
            { name: 'Toronto', country: 'Kanada', province: 'Ontario', lat: 43.6532, lng: -79.3832 },
            { name: 'Montreal', country: 'Kanada', province: 'Quebec', lat: 45.5017, lng: -73.5673 },
            { name: 'Vancouver', country: 'Kanada', province: 'British Columbia', lat: 49.2827, lng: -123.1207 },
            { name: 'Calgary', country: 'Kanada', province: 'Alberta', lat: 51.0447, lng: -114.0719 },
            { name: 'Edmonton', country: 'Kanada', province: 'Alberta', lat: 53.5461, lng: -113.4938 },
            { name: 'Ottawa', country: 'Kanada', province: 'Ontario', lat: 45.4215, lng: -75.6972 },
            { name: 'Winnipeg', country: 'Kanada', province: 'Manitoba', lat: 49.8951, lng: -97.1384 },
            { name: 'Quebec City', country: 'Kanada', province: 'Quebec', lat: 46.8139, lng: -71.2080 },
            { name: 'Hamilton', country: 'Kanada', province: 'Ontario', lat: 43.2557, lng: -79.8711 },
            { name: 'Kitchener', country: 'Kanada', province: 'Ontario', lat: 43.4516, lng: -80.4925 },
            { name: 'London', country: 'Kanada', province: 'Ontario', lat: 42.9849, lng: -81.2453 },
            { name: 'Halifax', country: 'Kanada', province: 'Nova Scotia', lat: 44.6488, lng: -63.5752 },
            { name: 'Victoria', country: 'Kanada', province: 'British Columbia', lat: 48.4284, lng: -123.3656 },
            
            // Mexican Cities
            { name: 'Mexico City', country: 'Meksika', state: 'México', lat: 19.4326, lng: -99.1332 },
            { name: 'Guadalajara', country: 'Meksika', state: 'Jalisco', lat: 20.6597, lng: -103.3496 },
            { name: 'Monterrey', country: 'Meksika', state: 'Nuevo León', lat: 25.6866, lng: -100.3161 },
            { name: 'Puebla', country: 'Meksika', state: 'Puebla', lat: 19.0414, lng: -98.2063 },
            { name: 'Tijuana', country: 'Meksika', state: 'Baja California', lat: 32.5149, lng: -117.0382 },
            { name: 'León', country: 'Meksika', state: 'Guanajuato', lat: 21.1619, lng: -101.6921 },
            { name: 'Juárez', country: 'Meksika', state: 'Chihuahua', lat: 31.6904, lng: -106.4245 },
            { name: 'Zapopan', country: 'Meksika', state: 'Jalisco', lat: 20.7214, lng: -103.3918 },
            { name: 'Nezahualcóyotl', country: 'Meksika', state: 'México', lat: 19.4003, lng: -99.0147 },
            { name: 'Chihuahua', country: 'Meksika', state: 'Chihuahua', lat: 28.6353, lng: -106.0889 },
            { name: 'Naucalpan', country: 'Meksika', state: 'México', lat: 19.4779, lng: -99.2386 }
        ];
        
        // Activity management
        const availableActivities = {
            running: {
                id: 'running',
                name: 'Koşu',
                icon: '🏃‍♂️',
                bgColor: 'bg-green-50',
                borderColor: 'border-green-200',
                iconBg: 'bg-green-100',
                statusColor: 'text-green-700',
                dotColor: 'bg-green-500'
            },
            cycling: {
                id: 'cycling',
                name: 'Bisiklet',
                icon: '🚴‍♂️',
                bgColor: 'bg-yellow-50',
                borderColor: 'border-yellow-200',
                iconBg: 'bg-yellow-100',
                statusColor: 'text-yellow-700',
                dotColor: 'bg-yellow-500'
            },
            walking: {
                id: 'walking',
                name: 'Yürüyüş',
                icon: '🚶‍♂️',
                bgColor: 'bg-green-50',
                borderColor: 'border-green-200',
                iconBg: 'bg-green-100',
                statusColor: 'text-green-700',
                dotColor: 'bg-green-500'
            },
            sports: {
                id: 'sports',
                name: 'Açık Hava Sporu',
                icon: '⚽',
                bgColor: 'bg-green-50',
                borderColor: 'border-green-200',
                iconBg: 'bg-green-100',
                statusColor: 'text-green-700',
                dotColor: 'bg-green-500'
            },
            swimming: {
                id: 'swimming',
                name: 'Yüzme',
                icon: '🏊‍♂️',
                bgColor: 'bg-blue-50',
                borderColor: 'border-blue-200',
                iconBg: 'bg-blue-100',
                statusColor: 'text-blue-700',
                dotColor: 'bg-blue-500'
            },
            hiking: {
                id: 'hiking',
                name: 'Doğa Yürüyüşü',
                icon: '🥾',
                bgColor: 'bg-orange-50',
                borderColor: 'border-orange-200',
                iconBg: 'bg-orange-100',
                statusColor: 'text-orange-700',
                dotColor: 'bg-orange-500'
            },
            tennis: {
                id: 'tennis',
                name: 'Tenis',
                icon: '🎾',
                bgColor: 'bg-purple-50',
                borderColor: 'border-purple-200',
                iconBg: 'bg-purple-100',
                statusColor: 'text-purple-700',
                dotColor: 'bg-purple-500'
            },
            golf: {
                id: 'golf',
                name: 'Golf',
                icon: '⛳',
                bgColor: 'bg-emerald-50',
                borderColor: 'border-emerald-200',
                iconBg: 'bg-emerald-100',
                statusColor: 'text-emerald-700',
                dotColor: 'bg-emerald-500'
            }
        };
        
        let selectedActivities = ['running', 'cycling']; // Default activities
        let currentActivityIndex = 0;
        
        function getWindTrend() {
            const trends = [
                { icon: '<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 17l9.2-9.2M17 17V7H7"></path></svg>', color: 'text-green-600' },
                { icon: '<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 7l-9.2 9.2M7 7v10h10"></path></svg>', color: 'text-red-600' },
                { icon: '<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg>', color: 'text-gray-600' }
            ];
            return trends[Math.floor(Math.random() * trends.length)];
        }
        
        function getPollenTrend() {
            const trends = [
                { icon: '<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 17l9.2-9.2M17 17V7H7"></path></svg>', color: 'text-orange-600' },
                { icon: '<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 7l-9.2 9.2M7 7v10h10"></path></svg>', color: 'text-green-600' },
                { icon: '<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg>', color: 'text-gray-600' }
            ];
            return trends[Math.floor(Math.random() * trends.length)];
        }
        
        function getActivityStatus(activityId, aqi) {
            // Generate activity status based on AQI and activity type
            if (aqi <= 50) {
                const descriptions = {
                    running: 'Koşu için mükemmel hava koşulları',
                    cycling: 'Bisiklet sürüş için ideal koşullar',
                    walking: 'Yürüyüş için harika bir gün',
                    sports: 'Açık hava sporu için uygun',
                    swimming: 'Yüzme için temiz hava',
                    hiking: 'Doğa yürüyüşü için perfect',
                    tennis: 'Tenis oynamak için ideal',
                    golf: 'Golf için mükemmel koşullar'
                };
                return { status: 'Mükemmel', description: descriptions[activityId] || 'Aktivite için uygun' };
            } else if (aqi <= 100) {
                if (activityId === 'running' || activityId === 'cycling') {
                    return { status: 'Dikkatli', description: 'Yoğun egzersiz sırasında dikkat edin' };
                } else if (activityId === 'walking' || activityId === 'golf') {
                    return { status: 'Uygun', description: 'Hafif aktiviteler için sorun yok' };
                } else {
                    return { status: 'Orta', description: 'Kısa süreli aktiviteler önerilir' };
                }
            } else {
                const warnings = {
                    running: 'Koşu önerilmez, kapalı alanda egzersiz yapın',
                    cycling: 'Bisiklet sürmekten kaçının',
                    walking: 'Kısa yürüyüşler, maske ile',
                    sports: 'Açık hava sporlarından kaçının',
                    swimming: 'Kapalı havuz tercih edin',
                    hiking: 'Doğa yürüyüşünü erteleyin',
                    tennis: 'Kapalı kort tercih edin',
                    golf: 'Golf oynamayı erteleyin'
                };
                return { status: 'Önerilmez', description: warnings[activityId] || 'Aktivite önerilmez' };
            }
        }
        
        function updateActivityDisplay() {
            const container = document.getElementById('activityContainer');
            if (!container) return;
            
            const currentAQI = parseInt(document.getElementById('aqiValue').textContent) || 42;
            const currentWind = parseInt(document.getElementById('windValue').textContent) || 12;
            const currentPollen = document.getElementById('pollenValue').textContent || 'Orta';
            
            // Clear container
            container.innerHTML = '';
            
            // Add selected activities
            selectedActivities.forEach(activityId => {
                const activity = availableActivities[activityId];
                if (!activity) return;
                
                const status = getActivityStatus(activityId, currentAQI);
                const windTrend = getWindTrend();
                const pollenTrend = getPollenTrend();
                
                const activityCard = document.createElement('div');
                activityCard.className = `flex-shrink-0 w-full h-full p-4 ${activity.bgColor} rounded-lg border ${activity.borderColor} flex flex-col justify-between`;
                
                activityCard.innerHTML = `
                    <div class="flex items-center gap-4 mb-3">
                        <div class="w-16 h-16 ${activity.iconBg} rounded-full flex items-center justify-center">
                            <span class="text-3xl">${activity.icon}</span>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-xl font-semibold text-gray-800 mb-1">${activity.name}</h4>
                            <p class="text-sm text-gray-600 mb-2">${status.description}</p>
                            <div class="flex items-center gap-3">
                                <div class="w-4 h-4 ${activity.dotColor} rounded-full"></div>
                                <span class="text-lg font-semibold ${activity.statusColor}">${status.status}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="space-y-2">
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-600">Rüzgar</span>
                            <div class="flex items-center gap-1 ${windTrend.color}">
                                ${windTrend.icon}
                                <span class="font-medium">${currentWind} km/h</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-600">Polen</span>
                            <div class="flex items-center gap-1 ${pollenTrend.color}">
                                ${pollenTrend.icon}
                                <span class="font-medium">${currentPollen}</span>
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(activityCard);
            });
            
            // Add settings card at the end
            const settingsCard = document.createElement('div');
            settingsCard.className = 'flex-shrink-0 w-full h-full p-4 bg-gray-50 rounded-lg border border-gray-200 flex flex-col justify-center';
            settingsCard.innerHTML = `
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center">
                        <span class="text-3xl">⚙️</span>
                    </div>
                    <div class="flex-1">
                        <h4 class="text-xl font-semibold text-gray-800 mb-2">Aktivite Ayarla</h4>
                    </div>
                </div>
                <p class="text-base text-gray-700 text-center mb-4">Hangi aktiviteleri takip etmek istiyorsunuz?</p>
                <button onclick="showSection('settings')" class="w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-lg font-medium">
                    Ayarları Düzenle
                </button>
            `;
            
            container.appendChild(settingsCard);
            
            // Update container width and initialize slider
            const containerWidth = container.parentElement.offsetWidth;
            const totalItems = selectedActivities.length + 1;
            container.style.width = `${totalItems * containerWidth}px`;
            
            // Set each card width to match container
            const cards = container.children;
            for (let card of cards) {
                card.style.width = `${containerWidth}px`;
            }
            
            // Update dots and slider position
            updateActivityDots();
            updateActivitySlider();
        }
        
        function updateActivityPreferences() {
            // Get selected activities from checkboxes
            selectedActivities = [];
            
            Object.keys(availableActivities).forEach(activityId => {
                const checkbox = document.getElementById(`activity-${activityId}`);
                if (checkbox && checkbox.checked) {
                    selectedActivities.push(activityId);
                }
            });
            
            // Reset current index
            currentActivityIndex = 0;
            
            // Update the display
            updateActivityDisplay();
            
            // Show notification
            showNotification('Aktivite tercihleri güncellendi', 'success');
        }
        
        function nextActivity() {
            const totalItems = selectedActivities.length + 1; // +1 for settings card
            currentActivityIndex = (currentActivityIndex + 1) % totalItems;
            updateActivitySlider();
        }
        
        function previousActivity() {
            const totalItems = selectedActivities.length + 1; // +1 for settings card
            currentActivityIndex = (currentActivityIndex - 1 + totalItems) % totalItems;
            updateActivitySlider();
        }
        
        function goToActivity(index) {
            currentActivityIndex = index;
            updateActivitySlider();
        }
        
        function updateActivitySlider() {
            const container = document.getElementById('activityContainer');
            const containerWidth = container.parentElement.offsetWidth;
            const translateX = -currentActivityIndex * containerWidth;
            
            container.style.transform = `translateX(${translateX}px)`;
            
            // Update dots
            updateActivityDots();
        }
        
        function updateActivityDots() {
            const dotsContainer = document.getElementById('activityDots');
            const totalItems = selectedActivities.length + 1; // +1 for settings card
            
            dotsContainer.innerHTML = '';
            
            for (let i = 0; i < totalItems; i++) {
                const dot = document.createElement('button');
                dot.className = `w-2 h-2 rounded-full transition-colors ${
                    i === currentActivityIndex ? 'bg-blue-600' : 'bg-gray-300'
                }`;
                dot.onclick = () => goToActivity(i);
                dotsContainer.appendChild(dot);
            }
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeMap();
            startDataUpdates();
            updateActivityDisplay(); // Initialize activity display
            
            // Add initial current location marker
            if (currentLocationData) {
                setTimeout(() => {
                    addCurrentLocationMarker(currentLocationData.lat, currentLocationData.lng, currentLocationData.name, currentLocationData);
                }, 1000);
            }
        });
        
        // Search suggestions
        function showSearchSuggestions(query) {
            const dropdown = document.getElementById('searchSuggestions');
            
            if (!query || query.length < 1) {
                dropdown.classList.add('hidden');
                return;
            }
            
            // Search countries
            const filteredCountries = northAmericanCountries.filter(country => 
                country.name.toLowerCase().includes(query.toLowerCase())
            );
            
            // Search states/provinces
            const filteredStates = northAmericanStates.filter(state => 
                state.name.toLowerCase().includes(query.toLowerCase()) ||
                state.country.toLowerCase().includes(query.toLowerCase())
            ).slice(0, 4);
            
            // Search cities
            const filteredCities = northAmericanCities.filter(city => 
                city.name.toLowerCase().includes(query.toLowerCase()) ||
                city.country.toLowerCase().includes(query.toLowerCase()) ||
                (city.state && city.state.toLowerCase().includes(query.toLowerCase())) ||
                (city.province && city.province.toLowerCase().includes(query.toLowerCase()))
            ).slice(0, 5);
            
            const allResults = [...filteredCountries, ...filteredStates, ...filteredCities];
            
            if (allResults.length === 0) {
                dropdown.classList.add('hidden');
                return;
            }
            
            dropdown.innerHTML = allResults.map(item => {
                if (item.type === 'country') {
                    return `
                        <div class="px-4 py-3 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors" 
                             onmousedown="selectLocation('${item.name}', 'country', ${item.lat}, ${item.lng}, '${item.name}', '')">
                            <div class="font-medium text-gray-800">${item.name}</div>
                            <div class="text-sm text-blue-600 font-medium">Ülke</div>
                        </div>
                    `;
                } else if (item.type === 'state' || item.type === 'province' || item.type === 'territory') {
                    const regionType = item.type === 'state' ? 'Eyalet' : item.type === 'province' ? 'Eyalet' : 'Bölge';
                    return `
                        <div class="px-4 py-3 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors" 
                             onmousedown="selectLocation('${item.name}', '${item.type}', ${item.lat}, ${item.lng}, '${item.country}', '${item.name}')">
                            <div class="font-medium text-gray-800">${item.country}, ${item.name}</div>
                            <div class="text-sm text-green-600 font-medium">${regionType}</div>
                        </div>
                    `;
                } else {
                    const locationInfo = item.state ? `${item.country}, ${item.state}, ${item.name}` : 
                                       item.province ? `${item.country}, ${item.province}, ${item.name}` : 
                                       `${item.country}, ${item.name}`;
                    const stateOrProvince = item.state || item.province || '';
                    return `
                        <div class="px-4 py-3 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors" 
                             onmousedown="selectLocation('${item.name}', 'city', ${item.lat}, ${item.lng}, '${item.country}', '${stateOrProvince}')">
                            <div class="font-medium text-gray-800">${locationInfo}</div>
                            <div class="text-sm text-orange-600 font-medium">Şehir</div>
                        </div>
                    `;
                }
            }).join('');
            
            dropdown.classList.remove('hidden');
        }
        
        function hideSearchSuggestions() {
            setTimeout(() => {
                document.getElementById('searchSuggestions').classList.add('hidden');
            }, 200);
        }
        
        function selectLocation(name, type, lat, lng, country, stateOrProvince) {
            // Create full location name for display
            let fullLocationName = name;
            if (type === 'city' && stateOrProvince) {
                fullLocationName = `${name}, ${stateOrProvince}, ${country}`;
            } else if (type === 'state' || type === 'province' || type === 'territory') {
                fullLocationName = `${name}, ${country}`;
            }
            
            document.getElementById('searchInput').value = fullLocationName;
            document.getElementById('searchSuggestions').classList.add('hidden');
            updateLocationData(fullLocationName, lat, lng, type, country, stateOrProvince);
            
            if (map) {
                let zoomLevel;
                switch(type) {
                    case 'country':
                        zoomLevel = 4;
                        break;
                    case 'state':
                    case 'province':
                    case 'territory':
                        zoomLevel = 6;
                        break;
                    case 'city':
                        zoomLevel = 12;
                        break;
                    default:
                        zoomLevel = 8;
                }
                
                // Force map resize and then set view
                map.invalidateSize();
                setTimeout(() => {
                    map.setView([lat, lng], zoomLevel);
                    // Show map section if not already visible
                    if (document.getElementById('mapSection').classList.contains('hidden')) {
                        showSection('map');
                    }
                }, 200);
            }
        }
        
        // Navigation functions
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionName + 'Section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // If showing map section, resize the map
            if (sectionName === 'map' && map) {
                setTimeout(() => {
                    map.invalidateSize();
                    // Also update current location marker if exists
                    if (currentLocationData && currentLocationData.lat && currentLocationData.lng) {
                        addCurrentLocationMarker(currentLocationData.lat, currentLocationData.lng, currentLocationData.name, currentLocationData);
                    }
                }, 100);
            }
            
            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-white', 'bg-opacity-20');
            });
            
            // Close mobile menu
            document.getElementById('mobileMenu').classList.add('hidden');
        }
        
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }
        
        // Forecast functions
        function showForecast(type) {
            // Update buttons
            document.getElementById('forecast7Day').className = type === '7day' ? 
                'px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium shadow-sm' :
                'px-6 py-3 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors font-medium';
            
            document.getElementById('forecast24Hour').className = type === '24hour' ? 
                'px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium shadow-sm' :
                'px-6 py-3 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors font-medium';
            
            // Show/hide data
            document.getElementById('forecast7DayData').classList.toggle('hidden', type !== '7day');
            document.getElementById('forecast24HourData').classList.toggle('hidden', type !== '24hour');
        }
        
        // Map functions
        let statePolygons = [];
        
        function initializeMap() {
            try {
                // Wait for map container to be visible
                setTimeout(() => {
                    if (document.getElementById('map')) {
                        map = L.map('map').setView([45.0, -100.0], 4); // North America center
                        
                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            attribution: '© OpenStreetMap contributors'
                        }).addTo(map);
                        
                        // Force map to resize after initialization
                        setTimeout(() => {
                            if (map) {
                                map.invalidateSize();
                            }
                        }, 100);
                        
                        // Add sample markers for North American cities
                        const sampleLocations = [
                            {lat: 40.7128, lng: -74.0060, aqi: 65, name: 'New York City', pm25: 15, pm10: 22, no2: 28, o3: 85, temp: 22},
                            {lat: 34.0522, lng: -118.2437, aqi: 85, name: 'Los Angeles', pm25: 25, pm10: 35, no2: 35, o3: 95, temp: 28},
                            {lat: 41.8781, lng: -87.6298, aqi: 42, name: 'Chicago', pm25: 12, pm10: 18, no2: 22, o3: 75, temp: 18},
                            {lat: 43.6532, lng: -79.3832, aqi: 38, name: 'Toronto', pm25: 10, pm10: 15, no2: 20, o3: 70, temp: 15},
                            {lat: 49.2827, lng: -123.1207, aqi: 32, name: 'Vancouver', pm25: 8, pm10: 12, no2: 18, o3: 65, temp: 12},
                            {lat: 19.4326, lng: -99.1332, aqi: 125, name: 'Mexico City', pm25: 45, pm10: 65, no2: 55, o3: 120, temp: 25}
                        ];
                        
                        updateMapMarkers(sampleLocations);
                    }
                }, 500);
            } catch (error) {
                console.log('Map initialization failed, using fallback');
                document.getElementById('map').innerHTML = `
                    <div class="w-full h-96 bg-gradient-to-br from-blue-100 to-green-100 rounded-lg border-2 border-gray-200 flex items-center justify-center">
                        <div class="text-center">
                            <div class="text-6xl mb-4">🗺️</div>
                            <h3 class="text-xl font-semibold text-gray-700 mb-2">Kuzey Amerika Haritası</h3>
                            <p class="text-gray-600">Hava kalitesi verileri</p>
                        </div>
                    </div>
                `;
            }
        }
        
        function addStatePolygons() {
            // State polygons removed - showing only city points now
        }
        
        function updateStatePolygons() {
            // State polygon updates removed - only city points are shown
        }
        
        function changeMapLayer(layer) {
            currentMapLayer = layer;
            
            // Update button styles
            document.querySelectorAll('[id^="layer"]').forEach(btn => {
                btn.className = 'px-4 py-2 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium';
            });
            
            const activeBtn = document.getElementById('layer' + layer.toUpperCase().replace('25', '25').replace('10', '10'));
            if (activeBtn) {
                activeBtn.className = 'px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium';
            }
            
            // Update map markers with new data layer
            const sampleLocations = [
                {lat: 40.7128, lng: -74.0060, name: 'New York City', pm25: 15, pm10: 22, no2: 28, o3: 85, co: 0.8},
                {lat: 34.0522, lng: -118.2437, name: 'Los Angeles', pm25: 25, pm10: 35, no2: 35, o3: 95, co: 1.2},
                {lat: 41.8781, lng: -87.6298, name: 'Chicago', pm25: 12, pm10: 18, no2: 22, o3: 75, co: 0.6},
                {lat: 43.6532, lng: -79.3832, name: 'Toronto', pm25: 10, pm10: 15, no2: 20, o3: 70, co: 0.5},
                {lat: 49.2827, lng: -123.1207, name: 'Vancouver', pm25: 8, pm10: 12, no2: 18, o3: 65, co: 0.4},
                {lat: 19.4326, lng: -99.1332, name: 'Mexico City', pm25: 45, pm10: 65, no2: 55, o3: 120, co: 2.1}
            ];
            
            updateMapMarkers(sampleLocations);
            
            // Update current location marker with new layer data
            if (currentLocationData && currentLocationData.lat && currentLocationData.lng) {
                addCurrentLocationMarker(currentLocationData.lat, currentLocationData.lng, currentLocationData.name, currentLocationData);
            }
        }
        
        let currentLocationMarker = null;
        
        function updateMapMarkers(locations) {
            if (!map) return;
            
            // Clear existing markers (except current location marker)
            map.eachLayer(layer => {
                if (layer instanceof L.CircleMarker && layer !== currentLocationMarker) {
                    map.removeLayer(layer);
                }
            });
            
            locations.forEach(location => {
                let value, unit, color;
                
                switch(currentMapLayer) {
                    case 'pm25':
                        value = location.pm25;
                        unit = 'µg/m³';
                        color = getPollutantColor(value, 'pm25');
                        break;
                    case 'pm10':
                        value = location.pm10;
                        unit = 'µg/m³';
                        color = getPollutantColor(value, 'pm10');
                        break;
                    case 'no2':
                        value = location.no2;
                        unit = 'µg/m³';
                        color = getPollutantColor(value, 'no2');
                        break;
                    case 'o3':
                        value = location.o3;
                        unit = 'µg/m³';
                        color = getPollutantColor(value, 'o3');
                        break;
                    case 'co':
                        value = location.co;
                        unit = 'mg/m³';
                        color = getPollutantColor(value, 'co');
                        break;
                    default:
                        value = location.pm25;
                        unit = 'µg/m³';
                        color = getPollutantColor(value, 'pm25');
                }
                
                const marker = L.circleMarker([location.lat, location.lng], {
                    radius: 15,
                    fillColor: color,
                    color: color,
                    weight: 0,
                    opacity: 0,
                    fillOpacity: 1.0
                }).addTo(map);
                
                marker.bindPopup(`
                    <div class="text-center">
                        <h3 class="font-bold">${location.name}</h3>
                        <p class="text-lg">${currentMapLayer.toUpperCase()}: ${value} ${unit}</p>
                        <p class="text-sm">${getStatusForValue(value, currentMapLayer)}</p>
                    </div>
                `);
            });
        }
        
        function addCurrentLocationMarker(lat, lng, locationName, data) {
            if (!map) return;
            
            // Remove existing current location marker
            if (currentLocationMarker) {
                map.removeLayer(currentLocationMarker);
            }
            
            // Get current layer value and color
            let value, unit, color;
            switch(currentMapLayer) {
                case 'pm25':
                    value = data.pm25;
                    unit = 'µg/m³';
                    color = getPollutantColor(value, 'pm25');
                    break;
                case 'pm10':
                    value = data.pm10;
                    unit = 'µg/m³';
                    color = getPollutantColor(value, 'pm10');
                    break;
                case 'no2':
                    value = data.no2;
                    unit = 'µg/m³';
                    color = getPollutantColor(value, 'no2');
                    break;
                case 'o3':
                    value = data.o3;
                    unit = 'µg/m³';
                    color = getPollutantColor(value, 'o3');
                    break;
                case 'co':
                    value = data.co;
                    unit = 'mg/m³';
                    color = getPollutantColor(value, 'co');
                    break;
                default:
                    value = data.pm25;
                    unit = 'µg/m³';
                    color = getPollutantColor(value, 'pm25');
            }
            
            // Create special marker for current location (larger)
            currentLocationMarker = L.circleMarker([lat, lng], {
                radius: 20,
                fillColor: color,
                color: color,
                weight: 0,
                opacity: 0,
                fillOpacity: 1.0
            }).addTo(map);
            
            currentLocationMarker.bindPopup(`
                <div class="text-center">
                    <h3 class="font-bold text-blue-600">📍 ${locationName}</h3>
                    <p class="text-lg font-semibold">${currentMapLayer.toUpperCase()}: ${value} ${unit}</p>
                    <p class="text-sm">${getStatusForValue(value, currentMapLayer)}</p>
                    <p class="text-xs text-gray-500 mt-1">Seçili Konum</p>
                </div>
            `);
        }
        
        function getAQIColor(aqi) {
            if (aqi <= 50) return '#10b981';
            if (aqi <= 100) return '#f59e0b';
            if (aqi <= 150) return '#f97316';
            return '#ef4444';
        }
        
        function getPollutantColor(value, type) {
            // Simplified color coding for pollutants
            if (type === 'pm25') {
                if (value <= 12) return '#10b981';
                if (value <= 35) return '#f59e0b';
                return '#ef4444';
            }
            if (type === 'pm10') {
                if (value <= 20) return '#10b981';
                if (value <= 50) return '#f59e0b';
                return '#ef4444';
            }
            if (type === 'co') {
                if (value <= 1.0) return '#10b981';
                if (value <= 2.0) return '#f59e0b';
                return '#ef4444';
            }
            if (value <= 30) return '#10b981';
            if (value <= 60) return '#f59e0b';
            return '#ef4444';
        }
        
        function getTemperatureColor(temp) {
            if (temp <= 10) return '#3b82f6';
            if (temp <= 20) return '#10b981';
            if (temp <= 30) return '#f59e0b';
            return '#ef4444';
        }
        
        function getStatusForValue(value, type) {
            if (type === 'co') {
                if (value <= 1.0) return 'Düşük';
                if (value <= 2.0) return 'Orta';
                return 'Yüksek';
            }
            return value <= 30 ? 'Düşük' : value <= 60 ? 'Orta' : 'Yüksek';
        }
        
        function getAQIStatus(aqi) {
            if (aqi <= 50) return 'İyi';
            if (aqi <= 100) return 'Orta';
            if (aqi <= 150) return 'Sağlıksız';
            return 'Tehlikeli';
        }
        
        // Global variable to store current location data
        let currentLocationData = {
            name: 'New York City, ABD',
            lat: 40.7128,
            lng: -74.0060,
            aqi: 42,
            pm25: 12,
            pm10: 18,
            no2: 25,
            o3: 85,
            co: 0.8,
            temp: 22
        };
        
        // Search and location functions
        function searchLocation() {
            const query = document.getElementById('searchInput').value;
            if (query) {
                showNotification(`"${query}" için arama yapılıyor...`, 'info');
                setTimeout(() => {
                    updateLocationData(query);
                    showNotification('Konum güncellendi', 'success');
                }, 1000);
            }
        }
        
        function getCurrentLocation() {
            if (navigator.geolocation) {
                showNotification('Konum alınıyor...', 'info');
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        const locationName = `Mevcut Konum (${lat.toFixed(4)}, ${lng.toFixed(4)})`;
                        updateLocationData(locationName, lat, lng, 'current', 'Bilinmiyor', '');
                        showNotification('Konum başarıyla alındı', 'success');
                        
                        if (map) {
                            map.setView([lat, lng], 12);
                        }
                    },
                    (error) => {
                        showNotification('Konum alınamadı', 'error');
                    }
                );
            } else {
                showNotification('Tarayıcınız konum servisini desteklemiyor', 'error');
            }
        }
        
        function updateLocationData(location, lat, lng, type, country, stateOrProvince) {
            document.getElementById('currentLocation').textContent = `📍 ${location}`;
            
            // Generate realistic data based on location and region
            let newAQI, pm25, pm10, no2, o3, co, humidity, wind, precipitation, pressure, pollen, temp;
            let sunriseTime, sunsetTime, weatherDescription, weatherIcon;
            
            // Regional data patterns based on country and specific locations
            if (country === 'ABD') {
                if (location.includes('Los Angeles') || location.includes('California')) {
                    // California - high pollution, warm weather
                    newAQI = Math.floor(Math.random() * 40) + 60; // 60-100
                    pm25 = Math.floor(Math.random() * 15) + 20; // 20-35
                    pm10 = Math.floor(Math.random() * 20) + 30; // 30-50
                    no2 = Math.floor(Math.random() * 15) + 30; // 30-45
                    o3 = Math.floor(Math.random() * 30) + 80; // 80-110
                    temp = Math.floor(Math.random() * 8) + 22; // 22-30°C
                    humidity = Math.floor(Math.random() * 20) + 45; // 45-65%
                    weatherDescription = 'Güneşli';
                    weatherIcon = '☀️';
                    sunriseTime = '06:45';
                    sunsetTime = '17:30';
                } else if (location.includes('New York') || location.includes('Chicago') || location.includes('Boston')) {
                    // Northeast/Midwest - moderate pollution, cooler
                    newAQI = Math.floor(Math.random() * 35) + 35; // 35-70
                    pm25 = Math.floor(Math.random() * 12) + 10; // 10-22
                    pm10 = Math.floor(Math.random() * 15) + 15; // 15-30
                    no2 = Math.floor(Math.random() * 12) + 20; // 20-32
                    o3 = Math.floor(Math.random() * 25) + 65; // 65-90
                    temp = Math.floor(Math.random() * 10) + 15; // 15-25°C
                    humidity = Math.floor(Math.random() * 25) + 55; // 55-80%
                    weatherDescription = 'Parçalı bulutlu';
                    weatherIcon = '⛅';
                    sunriseTime = '06:42';
                    sunsetTime = '16:58';
                } else if (location.includes('Seattle') || location.includes('Portland') || location.includes('Washington')) {
                    // Pacific Northwest - clean air, rainy
                    newAQI = Math.floor(Math.random() * 25) + 25; // 25-50
                    pm25 = Math.floor(Math.random() * 8) + 5; // 5-13
                    pm10 = Math.floor(Math.random() * 10) + 8; // 8-18
                    no2 = Math.floor(Math.random() * 10) + 15; // 15-25
                    o3 = Math.floor(Math.random() * 20) + 50; // 50-70
                    temp = Math.floor(Math.random() * 8) + 8; // 8-16°C
                    humidity = Math.floor(Math.random() * 20) + 70; // 70-90%
                    weatherDescription = 'Yağmurlu';
                    weatherIcon = '🌧️';
                    sunriseTime = '07:15';
                    sunsetTime = '16:45';
                } else if (location.includes('Texas') || location.includes('Houston') || location.includes('Dallas')) {
                    // Texas - hot, moderate pollution
                    newAQI = Math.floor(Math.random() * 30) + 45; // 45-75
                    pm25 = Math.floor(Math.random() * 15) + 12; // 12-27
                    pm10 = Math.floor(Math.random() * 18) + 18; // 18-36
                    no2 = Math.floor(Math.random() * 15) + 25; // 25-40
                    o3 = Math.floor(Math.random() * 35) + 75; // 75-110
                    temp = Math.floor(Math.random() * 10) + 25; // 25-35°C
                    humidity = Math.floor(Math.random() * 30) + 60; // 60-90%
                    weatherDescription = 'Sıcak ve nemli';
                    weatherIcon = '🌤️';
                    sunriseTime = '06:30';
                    sunsetTime = '18:15';
                } else {
                    // Other US states - average values
                    newAQI = Math.floor(Math.random() * 40) + 35; // 35-75
                    pm25 = Math.floor(Math.random() * 15) + 8; // 8-23
                    pm10 = Math.floor(Math.random() * 20) + 12; // 12-32
                    no2 = Math.floor(Math.random() * 15) + 18; // 18-33
                    o3 = Math.floor(Math.random() * 30) + 60; // 60-90
                    temp = Math.floor(Math.random() * 12) + 16; // 16-28°C
                    humidity = Math.floor(Math.random() * 30) + 50; // 50-80%
                    weatherDescription = 'Değişken';
                    weatherIcon = '⛅';
                    sunriseTime = '06:50';
                    sunsetTime = '17:20';
                }
            } else if (country === 'Kanada') {
                if (location.includes('Vancouver') || location.includes('British Columbia')) {
                    // BC - very clean air, mild and wet
                    newAQI = Math.floor(Math.random() * 25) + 20; // 20-45
                    pm25 = Math.floor(Math.random() * 6) + 4; // 4-10
                    pm10 = Math.floor(Math.random() * 8) + 6; // 6-14
                    no2 = Math.floor(Math.random() * 8) + 12; // 12-20
                    o3 = Math.floor(Math.random() * 15) + 45; // 45-60
                    temp = Math.floor(Math.random() * 8) + 8; // 8-16°C
                    humidity = Math.floor(Math.random() * 15) + 75; // 75-90%
                    weatherDescription = 'Sisli';
                    weatherIcon = '🌫️';
                    sunriseTime = '07:30';
                    sunsetTime = '16:30';
                } else if (location.includes('Toronto') || location.includes('Ontario')) {
                    // Ontario - moderate, continental climate
                    newAQI = Math.floor(Math.random() * 30) + 30; // 30-60
                    pm25 = Math.floor(Math.random() * 10) + 8; // 8-18
                    pm10 = Math.floor(Math.random() * 12) + 12; // 12-24
                    no2 = Math.floor(Math.random() * 12) + 18; // 18-30
                    o3 = Math.floor(Math.random() * 20) + 55; // 55-75
                    temp = Math.floor(Math.random() * 10) + 12; // 12-22°C
                    humidity = Math.floor(Math.random() * 25) + 60; // 60-85%
                    weatherDescription = 'Serin';
                    weatherIcon = '☁️';
                    sunriseTime = '07:00';
                    sunsetTime = '17:00';
                } else if (location.includes('Calgary') || location.includes('Alberta')) {
                    // Alberta - dry, cold, some pollution from oil
                    newAQI = Math.floor(Math.random() * 35) + 35; // 35-70
                    pm25 = Math.floor(Math.random() * 12) + 10; // 10-22
                    pm10 = Math.floor(Math.random() * 15) + 15; // 15-30
                    no2 = Math.floor(Math.random() * 15) + 20; // 20-35
                    o3 = Math.floor(Math.random() * 25) + 60; // 60-85
                    temp = Math.floor(Math.random() * 12) + 5; // 5-17°C
                    humidity = Math.floor(Math.random() * 20) + 40; // 40-60%
                    weatherDescription = 'Soğuk ve kuru';
                    weatherIcon = '❄️';
                    sunriseTime = '07:45';
                    sunsetTime = '16:15';
                } else {
                    // Other Canadian provinces - clean and cold
                    newAQI = Math.floor(Math.random() * 25) + 25; // 25-50
                    pm25 = Math.floor(Math.random() * 8) + 6; // 6-14
                    pm10 = Math.floor(Math.random() * 10) + 10; // 10-20
                    no2 = Math.floor(Math.random() * 10) + 15; // 15-25
                    o3 = Math.floor(Math.random() * 20) + 50; // 50-70
                    temp = Math.floor(Math.random() * 10) + 8; // 8-18°C
                    humidity = Math.floor(Math.random() * 25) + 65; // 65-90%
                    weatherDescription = 'Soğuk';
                    weatherIcon = '🌨️';
                    sunriseTime = '07:20';
                    sunsetTime = '16:45';
                }
            } else if (country === 'Meksika') {
                if (location.includes('Mexico City')) {
                    // Mexico City - very high pollution, high altitude
                    newAQI = Math.floor(Math.random() * 50) + 90; // 90-140
                    pm25 = Math.floor(Math.random() * 25) + 35; // 35-60
                    pm10 = Math.floor(Math.random() * 30) + 50; // 50-80
                    no2 = Math.floor(Math.random() * 25) + 45; // 45-70
                    o3 = Math.floor(Math.random() * 40) + 100; // 100-140
                    temp = Math.floor(Math.random() * 6) + 20; // 20-26°C
                    humidity = Math.floor(Math.random() * 20) + 50; // 50-70%
                    weatherDescription = 'Sisli ve kirli';
                    weatherIcon = '🌫️';
                    sunriseTime = '06:20';
                    sunsetTime = '18:45';
                } else if (location.includes('Tijuana') || location.includes('Baja California')) {
                    // Baja California - moderate pollution, dry
                    newAQI = Math.floor(Math.random() * 35) + 50; // 50-85
                    pm25 = Math.floor(Math.random() * 18) + 18; // 18-36
                    pm10 = Math.floor(Math.random() * 22) + 25; // 25-47
                    no2 = Math.floor(Math.random() * 18) + 25; // 25-43
                    o3 = Math.floor(Math.random() * 30) + 70; // 70-100
                    temp = Math.floor(Math.random() * 8) + 22; // 22-30°C
                    humidity = Math.floor(Math.random() * 20) + 45; // 45-65%
                    weatherDescription = 'Kuru ve sıcak';
                    weatherIcon = '☀️';
                    sunriseTime = '06:15';
                    sunsetTime = '18:30';
                } else {
                    // Other Mexican states - warm, moderate pollution
                    newAQI = Math.floor(Math.random() * 40) + 55; // 55-95
                    pm25 = Math.floor(Math.random() * 20) + 20; // 20-40
                    pm10 = Math.floor(Math.random() * 25) + 30; // 30-55
                    no2 = Math.floor(Math.random() * 20) + 30; // 30-50
                    o3 = Math.floor(Math.random() * 35) + 80; // 80-115
                    temp = Math.floor(Math.random() * 8) + 24; // 24-32°C
                    humidity = Math.floor(Math.random() * 30) + 55; // 55-85%
                    weatherDescription = 'Sıcak';
                    weatherIcon = '🌤️';
                    sunriseTime = '06:00';
                    sunsetTime = '19:00';
                }
            } else {
                // Default values for unknown locations
                newAQI = Math.floor(Math.random() * 50) + 40; // 40-90
                pm25 = Math.floor(Math.random() * 20) + 10; // 10-30
                pm10 = Math.floor(Math.random() * 25) + 15; // 15-40
                no2 = Math.floor(Math.random() * 20) + 20; // 20-40
                o3 = Math.floor(Math.random() * 35) + 65; // 65-100
                temp = Math.floor(Math.random() * 12) + 18; // 18-30°C
                humidity = Math.floor(Math.random() * 30) + 55; // 55-85%
                weatherDescription = 'Değişken';
                weatherIcon = '⛅';
                sunriseTime = '06:45';
                sunsetTime = '17:30';
            }
            
            // Common calculations for all locations
            co = (Math.random() * 1.5 + 0.3).toFixed(1); // 0.3-1.8 mg/m³
            wind = Math.floor(Math.random() * 15) + 5; // 5-20 km/h
            precipitation = (Math.random() * 5).toFixed(1); // 0-5mm
            pressure = Math.floor(Math.random() * 40) + 995; // 995-1035 hPa
            
            const pollenLevels = ['Düşük', 'Orta', 'Yüksek'];
            pollen = pollenLevels[Math.floor(Math.random() * pollenLevels.length)];
            
            // Update all displays
            updateAQIDisplay(newAQI);
            document.getElementById('pm25').textContent = pm25;
            document.getElementById('pm10').textContent = pm10;
            document.getElementById('no2').textContent = no2;
            document.getElementById('o3').textContent = o3;
            document.getElementById('co').textContent = co;
            
            // Update weather data
            document.querySelector('.text-3xl.font-bold.text-blue-600').textContent = temp + '°C';
            document.getElementById('humidityValue').textContent = humidity + '%';
            document.getElementById('windValue').textContent = wind + ' km/h';
            document.getElementById('precipitationValue').textContent = precipitation + 'mm';
            document.getElementById('pressureValue').textContent = pressure;
            document.getElementById('pollenValue').textContent = pollen;
            
            // Update weather description
            const weatherElements = document.querySelectorAll('.text-sm.text-gray-600');
            weatherElements.forEach(element => {
                if (element.textContent === 'Parçalı bulutlu') {
                    element.textContent = weatherDescription;
                }
            });
            
            // Update sunrise/sunset times
            document.getElementById('sunriseTime').textContent = sunriseTime;
            document.getElementById('sunsetTime').textContent = sunsetTime;
            
            // Update current location data for map
            currentLocationData = {
                name: location,
                lat: lat || 40.7128,
                lng: lng || -74.0060,
                aqi: newAQI,
                pm25: pm25,
                pm10: pm10,
                no2: no2,
                o3: o3,
                co: parseFloat(co),
                temp: temp
            };
            
            // Add current location marker to map
            if (lat && lng) {
                addCurrentLocationMarker(lat, lng, location, currentLocationData);
            }
            
            // Update all forecast data to match the region
            updateForecastData(country, stateOrProvince, temp, newAQI);
            
            showNotification(`${location} için veriler güncellendi`, 'success');
        }
        
        // Function to update forecast data based on region
        function updateForecastData(country, stateOrProvince, baseTemp, baseAQI) {
            // Update 7-day forecast table
            const forecastRows = document.querySelectorAll('#forecast7DayData tbody tr');
            
            forecastRows.forEach((row, index) => {
                const tempCell = row.querySelector('.text-xl.font-bold');
                const aqiCell = row.querySelector('.text-lg.font-semibold:last-child');
                const humidityCell = row.querySelector('.text-lg.font-semibold.text-cyan-600');
                const windCell = row.querySelector('.text-lg.font-semibold.text-violet-600');
                
                if (tempCell && aqiCell) {
                    // Generate temperature variation based on region and day
                    let tempVariation = Math.floor(Math.random() * 8) - 4; // -4 to +4
                    let newTemp = baseTemp + tempVariation;
                    
                    // Regional temperature adjustments
                    if (country === 'Kanada') {
                        newTemp = Math.max(newTemp - 5, -5); // Colder for Canada
                    } else if (country === 'Meksika') {
                        newTemp = Math.min(newTemp + 3, 40); // Warmer for Mexico
                    }
                    
                    // AQI variation
                    let aqiVariation = Math.floor(Math.random() * 20) - 10; // -10 to +10
                    let newAQI = Math.max(15, Math.min(200, baseAQI + aqiVariation));
                    
                    // Update cells
                    tempCell.textContent = `${newTemp}°C`;
                    aqiCell.textContent = newAQI;
                    
                    // Update AQI status
                    const statusCell = aqiCell.nextElementSibling;
                    if (statusCell) {
                        statusCell.textContent = getAQIStatus(newAQI);
                        
                        // Update AQI color
                        aqiCell.className = `text-lg font-semibold ${getAQIColorClass(newAQI)}`;
                    }
                    
                    // Update humidity based on region
                    if (humidityCell) {
                        let humidity = Math.floor(Math.random() * 30) + 50;
                        if (country === 'Kanada') humidity += 15; // More humid
                        if (country === 'Meksika' && !stateOrProvince?.includes('Baja')) humidity += 10;
                        humidityCell.textContent = `${Math.min(95, humidity)}%`;
                    }
                    
                    // Update wind
                    if (windCell) {
                        let wind = Math.floor(Math.random() * 15) + 5;
                        windCell.textContent = `${wind} km/h`;
                    }
                }
            });
            
            // Update 24-hour forecast table
            const hourlyRows = document.querySelectorAll('#forecast24HourData tbody tr');
            
            hourlyRows.forEach((row, index) => {
                const tempCell = row.querySelector('.font-bold');
                const humidityCell = row.querySelector('.text-cyan-600');
                const windCell = row.querySelector('.text-violet-600');
                
                if (tempCell) {
                    // Hourly temperature variation (smaller changes)
                    let hourlyTemp = baseTemp + Math.floor(Math.random() * 6) - 3;
                    
                    // Regional adjustments
                    if (country === 'Kanada') {
                        hourlyTemp = Math.max(hourlyTemp - 3, -10);
                    } else if (country === 'Meksika') {
                        hourlyTemp = Math.min(hourlyTemp + 2, 38);
                    }
                    
                    tempCell.textContent = `${hourlyTemp}°C`;
                }
                
                if (humidityCell) {
                    let humidity = Math.floor(Math.random() * 25) + 55;
                    if (country === 'Kanada') humidity += 10;
                    humidityCell.textContent = `${Math.min(95, humidity)}%`;
                }
                
                if (windCell) {
                    let wind = Math.floor(Math.random() * 12) + 5;
                    windCell.textContent = `${wind} km/h`;
                }
            });
        }
        
        function getAQIColorClass(aqi) {
            if (aqi <= 50) return 'text-green-600';
            if (aqi <= 100) return 'text-yellow-600';
            if (aqi <= 150) return 'text-orange-600';
            return 'text-red-600';
        }
        
        function updateAQIDisplay(aqi) {
            document.getElementById('aqiValue').textContent = aqi;
            document.getElementById('aqiStatus').textContent = getAQIStatus(aqi);
            
            const circle = document.getElementById('aqiCircle');
            const value = document.getElementById('aqiValue');
            const status = document.getElementById('aqiStatus');
            
            // Remove all AQI classes
            circle.className = circle.className.replace(/air-quality-\w+/g, '');
            
            // Add appropriate class and update colors
            if (aqi <= 50) {
                circle.classList.add('air-quality-good');
                value.className = 'text-6xl font-bold text-emerald-600';
                status.className = 'text-xl font-semibold text-emerald-600';
                circle.innerHTML = '<div class="text-center"><div class="text-2xl">😊</div><div class="text-xs">İyi</div></div>';
            } else if (aqi <= 100) {
                circle.classList.add('air-quality-moderate');
                value.className = 'text-6xl font-bold text-amber-600';
                status.className = 'text-xl font-semibold text-amber-600';
                circle.innerHTML = '<div class="text-center"><div class="text-2xl">😐</div><div class="text-xs">Orta</div></div>';
            } else if (aqi <= 150) {
                circle.classList.add('air-quality-unhealthy');
                value.className = 'text-6xl font-bold text-red-600';
                status.className = 'text-xl font-semibold text-red-600';
                circle.innerHTML = '<div class="text-center"><div class="text-2xl">😷</div><div class="text-xs">Kötü</div></div>';
            } else {
                circle.classList.add('air-quality-very-unhealthy');
                value.className = 'text-6xl font-bold text-violet-600';
                status.className = 'text-xl font-semibold text-violet-600';
                circle.innerHTML = '<div class="text-center"><div class="text-2xl">☠️</div><div class="text-xs">Tehlikeli</div></div>';
            }
            
            // Update activity display when AQI changes
            updateActivityDisplay();
        }
        
        // Notification system
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };
            
            notification.className = `${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg notification-slide`;
            notification.textContent = message;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // Data update simulation
        function startDataUpdates() {
            setInterval(() => {
                // Simulate small AQI changes
                const currentAQI = parseInt(document.getElementById('aqiValue').textContent);
                const change = Math.floor(Math.random() * 6) - 3; // -3 to +3
                const newAQI = Math.max(10, Math.min(200, currentAQI + change));
                
                if (newAQI !== currentAQI) {
                    updateAQIDisplay(newAQI);
                }
            }, 30000); // Update every 30 seconds
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9828649a27f4e116',t:'MTc1ODQ0NTQ0NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
